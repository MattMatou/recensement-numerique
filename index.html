<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Besoins Num√©riques ‚Äì Formulaire Officiel Prototype</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>

<header>
    <h1>Recensement des besoins num√©riques</h1>
    <p>Responsable : <strong>Mathys Millon</strong></p>
</header>

<main>

<section class="intro">
    <h2>Objectif</h2>
    <p>
        Ce formulaire permet de savoir les besoins des membres du personnel √©ducatif afin de faire un service r√©pondant √† vos besoins en mati√®re num√©rique.
    </p>
</section>

<section class="form-block">
    <h2>√âvaluation (1 = tr√®s difficile ‚Üí 4 = tr√®s facile)</h2>

    <form id="besoinsNumeriquesForm">


        <div class="question-block">
            <label>1. Utiliser l'ENT pour d√©poser des documents</label>
            <select name="Q1">
                <option>1</option><option>2</option><option>3</option><option>4</option>
            </select>
        </div>

        <div class="question-block">
            <label>2. Cr√©er un document PDF</label>
            <select name="Q2">
                <option>1</option><option>2</option><option>3</option><option>4</option>
            </select>
        </div>

        <div class="question-block">
            <label>3. Retrouver et organiser des fichiers dans votre ordinateur</label>
            <select name="Q3">
                <option>1</option><option>2</option><option>3</option><option>4</option>
            </select>
        </div>

        <div class="question-block">
            <label>4. Utiliser un logiciel de pr√©sentation (PowerPoint / Google Slides)</label>
            <select name="Q4">
                <option>1</option><option>2</option><option>3</option><option>4</option>
            </select>
        </div>

        <div class="question-block">
            <label>5. Utiliser un logiciel de traitement de texte (Word / Docs)</label>
            <select name="Q5">
                <option>1</option><option>2</option><option>3</option><option>4</option>
            </select>
        </div>

        <div class="question-block">
            <label>6. Utiliser un logiciel de tableur (Excel / Sheets)</label>
            <select name="Q6">
                <option>1</option><option>2</option><option>3</option><option>4</option>
            </select>
        </div>

        <div class="question-block">
            <label>7. R√©aliser une capture d‚Äô√©cran</label>
            <select name="Q7">
                <option>1</option><option>2</option><option>3</option><option>4</option>
            </select>
        </div>

        <div class="question-block">
            <label>8. Mettre √† jour un logiciel ou un appareil</label>
            <select name="Q8">
                <option>1</option><option>2</option><option>3</option><option>4</option>
            </select>
        </div>

        <div class="question-block">
            <label>9. Connecter un vid√©oprojecteur</label>
            <select name="Q9">
                <option>1</option><option>2</option><option>3</option><option>4</option>
            </select>
        </div>

        <div class="question-block">
            <label>10. Utiliser un tableau num√©rique interactif</label>
            <select name="Q10">
                <option>1</option><option>2</option><option>3</option><option>4</option>
            </select>
        </div>

        <div class="question-block"><label>11. Diffuser une vid√©o en classe</label><select name="Q11"><option>1</option><option>2</option><option>3</option><option>4</option></select></div>
        <div class="question-block"><label>12. Utiliser un QR code</label><select name="Q12"><option>1</option><option>2</option><option>3</option><option>4</option></select></div>
        <div class="question-block"><label>13. Utiliser une plateforme de visioconf√©rence</label><select name="Q13"><option>1</option><option>2</option><option>3</option><option>4</option></select></div>
        <div class="question-block"><label>14. Partager un fichier avec des √©l√®ves</label><select name="Q14"><option>1</option><option>2</option><option>3</option><option>4</option></select></div>
        <div class="question-block"><label>15. G√©rer des mots de passe s√©curis√©s</label><select name="Q15"><option>1</option><option>2</option><option>3</option><option>4</option></select></div>
        <div class="question-block"><label>16. Identifier un mail frauduleux</label><select name="Q16"><option>1</option><option>2</option><option>3</option><option>4</option></select></div>
        <div class="question-block"><label>17. Utiliser un ENT sur mobile</label><select name="Q17"><option>1</option><option>2</option><option>3</option><option>4</option></select></div>
        <div class="question-block"><label>18. Utiliser une imprimante r√©seau</label><select name="Q18"><option>1</option><option>2</option><option>3</option><option>4</option></select></div>
        <div class="question-block"><label>19. Scanner des documents</label><select name="Q19"><option>1</option><option>2</option><option>3</option><option>4</option></select></div>
        <div class="question-block"><label>20. Utiliser une cl√© USB de mani√®re s√©curis√©e</label><select name="Q20"><option>1</option><option>2</option><option>3</option><option>4</option></select></div>

        <div class="question-block"><label>21. Utiliser un casque/micro</label><select name="Q21"><option>1</option><option>2</option><option>3</option><option>4</option></select></div>
        <div class="question-block"><label>22. Organiser une classe virtuelle</label><select name="Q22"><option>1</option><option>2</option><option>3</option><option>4</option></select></div>
        <div class="question-block"><label>23. Modifier une image simple</label><select name="Q23"><option>1</option><option>2</option><option>3</option><option>4</option></select></div>
        <div class="question-block"><label>24. Utiliser un logiciel de montage vid√©o</label><select name="Q24"><option>1</option><option>2</option><option>3</option><option>4</option></select></div>
        <div class="question-block"><label>25. Installer une application p√©dagogique</label><select name="Q25"><option>1</option><option>2</option><option>3</option><option>4</option></select></div>

        <div class="question-block"><label>26. Utiliser une IA √©ducative</label><select name="Q26"><option>1</option><option>2</option><option>3</option><option>4</option></select></div>
        <div class="question-block"><label>27. Cr√©er un questionnaire num√©rique</label><select name="Q27"><option>1</option><option>2</option><option>3</option><option>4</option></select></div>
        <div class="question-block"><label>28. Utiliser un LMS (Moodle, Classroom‚Ä¶)</label><select name="Q28"><option>1</option><option>2</option><option>3</option><option>4</option></select></div>
        <div class="question-block"><label>29. Configurer un compte en ligne</label><select name="Q29"><option>1</option><option>2</option><option>3</option><option>4</option></select></div>
        <div class="question-block"><label>30. Partager un lien s√©curis√©</label><select name="Q30"><option>1</option><option>2</option><option>3</option><option>4</option></select></div>

        <div class="question-block"><label>31. Utiliser un drive partag√©</label><select name="Q31"><option>1</option><option>2</option><option>3</option><option>4</option></select></div>
        <div class="question-block"><label>32. Utiliser un cloud √©ducatif</label><select name="Q32"><option>1</option><option>2</option><option>3</option><option>4</option></select></div>
        <div class="question-block"><label>33. Prot√©ger les donn√©es personnelles (RGPD)</label><select name="Q33"><option>1</option><option>2</option><option>3</option><option>4</option></select></div>
        <div class="question-block"><label>34. Utiliser un navigateur de fa√ßon s√©curis√©e</label><select name="Q34"><option>1</option><option>2</option><option>3</option><option>4</option></select></div>
        <div class="question-block"><label>35. G√©rer les droits d‚Äôacc√®s √† un document</label><select name="Q35"><option>1</option><option>2</option><option>3</option><option>4</option></select></div>

        <div class="question-block"><label>36. Cr√©er un lien vers une ressource externe</label><select name="Q36"><option>1</option><option>2</option><option>3</option><option>4</option></select></div>
        <div class="question-block"><label>37. Travailler en mode collaboratif</label><select name="Q37"><option>1</option><option>2</option><option>3</option><option>4</option></select></div>
        <div class="question-block"><label>38. Exporter un fichier dans un autre format</label><select name="Q38"><option>1</option><option>2</option><option>3</option><option>4</option></select></div>
        <div class="question-block"><label>39. Compresser des fichiers</label><select name="Q39"><option>1</option><option>2</option><option>3</option><option>4</option></select></div>
        <div class="question-block"><label>40. Lire des supports num√©riques (cl√© USB, disque dur)</label><select name="Q40"><option>1</option><option>2</option><option>3</option><option>4</option></select></div>

        <div class="question-block"><label>41. Utiliser un logiciel de cr√©ation de cours</label><select name="Q41"><option>1</option><option>2</option><option>3</option><option>4</option></select></div>
        <div class="question-block"><label>42. Cr√©er une ressource interactive</label><select name="Q42"><option>1</option><option>2</option><option>3</option><option>4</option></select></div>
        <div class="question-block"><label>43. Utiliser un micro-logiciel disciplinaire</label><select name="Q43"><option>1</option><option>2</option><option>3</option><option>4</option></select></div>
        <div class="question-block"><label>44. Utiliser un logiciel de correction automatique</label><select name="Q44"><option>1</option><option>2</option><option>3</option><option>4</option></select></div>
        <div class="question-block"><label>45. G√©rer une classe num√©rique</label><select name="Q45"><option>1</option><option>2</option><option>3</option><option>4</option></select></div>

        <div class="question-block"><label>46. Cr√©er un planning en ligne</label><select name="Q46"><option>1</option><option>2</option><option>3</option><option>4</option></select></div>
        <div class="question-block"><label>47. Utiliser des plateformes p√©dagogiques officielles</label><select name="Q47"><option>1</option><option>2</option><option>3</option><option>4</option></select></div>
        <div class="question-block"><label>48. Stocker des documents dans le cloud</label><select name="Q48"><option>1</option><option>2</option><option>3</option><option>4</option></select></div>
        <div class="question-block"><label>49. G√©rer les permissions d‚Äôune ressource partag√©e</label><select name="Q49"><option>1</option><option>2</option><option>3</option><option>4</option></select></div>
        <div class="question-block"><label>50. Utiliser les outils num√©riques en autonomie totale</label><select name="Q50"><option>1</option><option>2</option><option>3</option><option>4</option></select></div>

        <h2>Demande d'ajout / commentaire</h2>
        <textarea name="Commentaire" rows="6" placeholder="√âcrivez ici votre demande, remarque ou proposition."></textarea>

        <button type="submit" id="submitButton">Envoyer</button>
    </form>
</section>

<section class="footer-note">
    <p>Prototype interne ‚Äì droits r√©serv√©s.</p>
</section>

</main>

<script>
    const DISCORD_WEBHOOK_URL = 'https://discord.com/api/webhooks/1443699713043075224/90fOYMBBdTO4sJuIQoc-vFNbY5QXjuKtIebCQ9hcCLxguVZ80esuhdKassrMNooaEWgv'; 
    const MENTION_ID = '1192202542696890401'; 
    
    const form = document.getElementById('besoinsNumeriquesForm');
    const submitButton = document.getElementById('submitButton');

    form.addEventListener('submit', async function(event) {
        event.preventDefault(); 
        
        let allRequestsOK = true; 
        const formData = new FormData(form);
        const data = Object.fromEntries(formData.entries());
        const timestamp = new Date().toISOString(); 
        const commentaire = data.Commentaire || "Aucun commentaire fourni.";

        submitButton.disabled = true; 

        const sendWebhook = async (title, fields, content = null) => {
            const payload = {
                content: content,
                embeds: [{
                    title: title,
                    color: 3447003, 
                    fields: fields,
                    timestamp: timestamp 
                }]
            };

            try {
                const response = await fetch(DISCORD_WEBHOOK_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    allRequestsOK = false;
                    console.error(`Erreur ${response.status} pour le webhook : ${title}`);
                }
            } catch (error) {
                allRequestsOK = false;
                console.error(`Erreur r√©seau lors de l'envoi de ${title}:`, error);
            }
        };


        let chunkFields = [];
        let webhookIndex = 1;

        for (let i = 1; i <= 50; i++) {
            const qKey = 'Q' + i;
            const selectElement = form.querySelector(`[name="${qKey}"]`);
            
            if (selectElement) {
                const labelElement = selectElement.previousElementSibling;
                const labelText = labelElement ? labelElement.textContent.trim() : `Question ${i}`;
                const cleanedLabel = labelText.replace(/^\d+\.\s*/, ''); 

                chunkFields.push({
                    name: `[Q${i}] ${cleanedLabel}`,
                    value: `Score: **${data[qKey]}** / 4`,
                    inline: true
                });
            }

            if (i % 10 === 0) {
                await sendWebhook(`üìã Recensement - Partie ${webhookIndex} (Q${i-9} √† Q${i})`, chunkFields);
                chunkFields = []; 
                webhookIndex++;
            }
        }
        
        const commentFields = [
            { name: "üí¨ Commentaire", value: commentaire, inline: false }
        ];
        await sendWebhook(
            "Finalisation du Recensement", 
            commentFields, 
            `**<@${MENTION_ID}>** - üì® Nouvelle soumission du Recensement Num√©rique re√ßue.`
        );

        if (allRequestsOK) {
            alert('‚úÖ Recensement envoy√© avec succ√®s √† Mathys en plusieurs parties ! Merci de vos r√©ponses.');
            form.reset();
            window.scrollTo({ top: 0, behavior: "smooth" });
        } else {
            alert('‚ùå Erreur lors de l\'envoi. V√©rifiez la console pour les d√©tails et l\'URL du webhook.');
        }
        
        submitButton.disabled = false; 
    });
</script>

</body>
</html>